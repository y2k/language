package im.y2k.chargetimer;import android.app.Activity;import android.app.NotificationChannel;import android.app.Notification;import android.app.NotificationManager;import android.webkit.WebView;import android.webkit.JavascriptInterface;import android.content.Intent;import android.content.Context;import android.content.IntentFilter;import android.content.BroadcastReceiver;import android.content.ComponentName;import android.media.AudioManager;import android.media.RingtoneManager;import android.app.job.JobScheduler;import android.app.job.JobParameters;import android.app.job.JobInfo;import java.util.List;import java.util.Objects;import java.util.function.BiFunction;class Main {public static class WebViewJsListener extends Object{public java.util.List<Object> state;public WebViewJsListener(Activity p0,WebView p1){state=java.util.List.of(p0,p1);}@JavascriptInterface public void dispatch(String p0, String p1){wv_dispatch(this,p0,p1);}}
private static Object wv_dispatch(final WebViewJsListener self,final String event,final String payload){final var activity=(Activity)y2k.RT.get(self.state,0);final var wv=y2k.RT.get(self.state,1);activity.runOnUiThread(()->{InterpreterKt.run_code(activity,wv,event);});final var p__1=(Void)null;return p__1;}
public static Object main(final Activity context,final WebView webview){final var webSettings=webview.getSettings();webSettings.setJavaScriptEnabled(true);webSettings.setAllowUniversalAccessFromFileURLs(true);webview.addJavascriptInterface(new WebViewJsListener(context,webview),"Android");webview.loadUrl("file:///android_asset/index.html");final var p__2=(Void)null;return p__2;}
public static class ChargeJobService extends android.app.job.JobService{public java.util.List<Object> state;@Override public boolean onStartJob(JobParameters p0){return (boolean)cj_onStartJob(this,p0);}@Override public boolean onStopJob(JobParameters p0){return (boolean)cj_onStopJob(this,p0);}}
public static Object cj_onStartJob(final ChargeJobService self,final JobParameters p){InterpreterKt.run_code(self,null,"job_scheduled");return false;}
public static Object cj_onStopJob(final ChargeJobService self,final JobParameters p){return false;}
public static BiFunction<String,Object,Object> make_dispatch(final Activity activity,final WebView webView){return (String event,Object payload)->{final var gen_1=event;final Object p__8;if(Objects.equals(gen_1,"start_job")){final var job_info=new JobInfo.Builder(123,new ComponentName(activity,"im.y2k.chargetimer.ChargeJobService")).setPeriodic(300000).setRequiresCharging(true).build();final var job_scheduler=(JobScheduler)activity.getSystemService(Context.JOB_SCHEDULER_SERVICE);final var p__4=job_scheduler.schedule(job_info);p__8=p__4;}else{final Object p__7;if(Objects.equals(gen_1,"stop_job")){activity.getSystemService(JobScheduler.class).cancel(123);p__7=(Void)null;}else{final Object p__6;if(Objects.equals(gen_1,"get_job_info")){final var callback="(FIXME)";final var service=(JobScheduler)activity.getSystemService(Context.JOB_SCHEDULER_SERVICE);final var m=android.app.job.JobInfo.getMinPeriodMillis();final var reason=service.getPendingJob(123);webView.evaluateJavascript(y2k.RT.str(callback,"('",m," / ",reason,"')"),null);final var p__5=(Void)null;p__6=p__5;}else{p__6=null;}p__7=p__6;}p__8=p__7;}final var p__3=p__8;return p__3;};}}